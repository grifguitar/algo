# ะัะฐะบัะธะบะฐ 6. ะกััะพะบะธ: ะฟัะตัะธะบั ะธ z-ััะฝะบัะธั, ัะตัะธ (11 ะพะบััะฑัั)

ะััะฟะฟะฐ 3, ะฟัะตะฟ. ะฅะปััะธะฝ ะัะธะณะพัะธะน

### ะัะฟะพะปัะทัะตะผัะต ะพะฑะพะทะฝะฐัะตะฝะธั:

ะะฟัะตะดะตะปะตะฝะธะต: *__ะฝะพะฒัะน ัะตัะผะธะฝ__*

* `s` โ ัััะพะบะฐ
* `|s|` โ ะดะปะธะฝะฐ ัััะพะบะธ
* `t` โ *__ะฟะพะดัััะพะบะฐ__* ัััะพะบะธ ๐, ะตัะปะธ `โ l, r: t = s[l : r)`
* `s[l : r)` ะธ `s[l : r]` โ ะฟะพะดัััะพะบะธ (ะฟัะฐะฒะฐั ะณัะฐะฝะธัะฐ ะฝะต ะฒะบะปััะธัะตะปัะฝะพ ะธ ะฒะบะปััะธัะตะปัะฝะพ ัะพะพัะฒะตัััะฒะตะฝะฝะพ)
* `s[0 : i)` โ *__ะฟัะตัะธะบั__* ัััะพะบะธ
* `s[i : |s|)` โ *__ััััะธะบั__* ัััะพะบะธ
* `ฮฃ` โ ะฐะปัะฐะฒะธั
* `|ฮฃ|` โ ัะฐะทะผะตั ะฐะปัะฐะฒะธัะฐ

ะะดะตัั ะธ ะดะฐะปะตะต ะฑัะดะตะผ ััะธัะฐัั, ััะพ ะธะฝะดะตะบัะฐัะธั ัััะพะบ ั ะฝัะปั.

## 1. gcd โ ัะพะถะต ะฟะตัะธะพะด!

*__ะะตัะธะพะด__* ัััะพะบะธ ๐ โ ัะธัะปะพ ๐ฅ, ัะฐะบะพะต ััะพ ๐ ัะฒะปัะตััั ะฟัะตัะธะบัะพะผ ัััะพะบะธ `s[0 : x)โ`. ะะตัะธะพะด ะฝะฐะทัะฒะฐะตััั *__ัะตะปัะผ__*,
ะตัะปะธ `|๐| โ ๐ฅ`. ะัััั ั ัััะพะบะธ ๐ ะตััั ะฟะตัะธะพะดั `๐, ๐ โค |๐| / 2`. ะะพะบะฐะถะธัะต, ััะพ gcd(๐, ๐) โ ัะพะถะต ะฟะตัะธะพะด.

### ะะตัะตะฝะธะต:

ะะฐััะผะพััะธะผ ัััะพะบั ๐, ั ะบะพัะพัะพะน ะตััั ะฟะตัะธะพะดั `๐, ๐` (ะฑะตะท ะพะณัะฐะฝะธัะตะฝะธั ะพะฑัะฝะพััะธ ัะบะฐะถะตะผ `๐ โค ๐`):

ะัะธะผะตั:

```haskell
s := "A B C D A B C D A B C D"  -- ะฟะตัะธะพะด ๐ = 4
s := "A B C D E F A B C D E F"  -- ะฟะตัะธะพะด ๐ = 6
```

ะะฐัะฟะธัะตะผ ะพะฟัะตะดะตะปะตะฝะธะต *__ะฟะตัะธะพะดะฐ__* ัะฐะฒะฝะพะณะพ _k_:

```haskell
s[i] = s[i + k], for all i
```

ะ ะฝะฐัะตะน ะทะฐะดะฐัะต ะฟะพ ััะปะพะฒะธั:

```haskell
1. s[i] = s[i + b], for all i
2. s[i] = s[i + a], for all i
Therefore
3. s[i] = s[i + b - a], for all i
```

ะขะฐะบะธะผ ะพะฑัะฐะทะพะผ, ัะฐััะผะฐััะธะฒะฐั ะฟะฐัั ะฟะตัะธะพะดะพะฒ (๐, ๐), ะผั ะผะพะถะตะผ ะฟะตัะตะนัะธ ะบ ัะฐััะผะพััะตะฝะธั ะฟะฐัั (๐, ๐ - ๐)

ะงัะพ ััะพ ะฝะฐะฟะพะผะธะฝะฐะตั? ะัะฐะฒะธะปัะฝะพ, ะฐะปะณะพัะธัะผ ะะฒะบะปะธะดะฐ ะฝะฐัะพะถะดะตะฝะธั ะฝะฐะธะฑะพะปััะตะณะพ ะพะฑัะตะณะพ ะดะตะปะธัะตะปั. ะะฐะผะตัะธะผ, ััะพ ะผั ะฒัะตะณะดะฐ ัะผะตะฝััะฐะตะผ
ะฟะฐัั, ะฟะพััะพะผั ััะพั ะฟัะพัะตัั ะณะฐัะฐะฝัะธัะพะฒะฐะฝะฝะพ ะทะฐะฒะตััะธััั ะธ ะผั ะฟะพะปััะธะผ, ััะพ gcd(๐, ๐) โ ัะพะถะต ะฟะตัะธะพะด ัััะพะบะธ ๐.

## 2. ะ ะฟะพะธัะบะฐั ะฟะตัะธะพะดะฐ

* ะะฐะนัะธ ะบัะฐััะฐะนัะธะน ะฟะตัะธะพะด ัััะพะบะธ ััะตะผั ัะฟะพัะพะฑะฐะผะธ: ๐-ััะฝะบัะธะธ, Z-ััะฝะบัะธั, ัะตัะธ.
* ะะฐะนัะธ ะฒัะต ะฟะตัะธะพะดั ัััะพะบะธ.

### ะขะตะพั. ัะฟัะฐะฒะบะฐ:

ะะฟัะตะดะตะปะธะผ **_ััะฝะบัะธั_ ๐0** ะพั ัััะพะบะธ ๐: ๐0(๐) โ ะดะปะธะฝะฐ ะผะฐะบัะธะผะฐะปัะฝะพะณะพ **_ัะพะฑััะฒะตะฝะฝะพะณะพ_** (ะฝะต ัะพะฒะฟะฐะดะฐััะตะณะพ ัะพ ะฒัะตะน
ัััะพะบะพะน) ะฟัะตัะธะบัะฐ ๐, ัะพะฒะฟะฐะดะฐััะตะณะพ c ััััะธะบัะพะผ ๐.

ะัะธะผะตั:

```haskell
๐0("A B C A B")   = 2  -- ั.ะบ. ะผะฐะบั. ัะพะฑััะฒะตะฝะฝัะน ะฟัะตัะธะบั, ัะพะฒะฟะฐะดะฐััะธะน ั ัััะธะบัะพะผ, ััะพ ะฟะพะดัััะพะบะฐ "A B"
๐0("A B A B A B") = 4  -- ั.ะบ. ะผะฐะบั. ัะพะฑััะฒะตะฝะฝัะน ะฟัะตัะธะบั, ัะพะฒะฟะฐะดะฐััะธะน ั ัััะธะบัะพะผ, ััะพ ะฟะพะดัััะพะบะฐ "A B A B"
๐0("A")           = 0  -- ั.ะบ. ะฝะต ัััะตััะฒัะตั ัะพะฑััะฒะตะฝะฝะพะณะพ ะฟัะตัะธะบัะฐ, ัะพะฒะฟะฐะดะฐััะตะณะพ ั ัััะธะบัะพะผ
๐0("A A A A")     = 3  -- ั.ะบ. ะผะฐะบั. ัะพะฑััะฒะตะฝะฝัะน ะฟัะตัะธะบั, ัะพะฒะฟะฐะดะฐััะธะน ั ัััะธะบัะพะผ, ััะพ ะฟะพะดัััะพะบะฐ "A A A"
```

ะขะตะฟะตัั ะพะฟัะตะดะตะปะธะผ **_ะฟัะตัะธะบั-ััะฝะบัะธั_** ัััะพะบะธ ๐: ๐(๐) โ ะผะฐััะธะฒ ๐ ะดะปะธะฝั |๐| + 1, ัะฐะบะพะน ััะพ:

* `๐[0] = -1`
* `๐[i] = ๐0( ๐[0 : i) ), for all i`

ะัะธะผะตั:

```haskell
s := "A A B A A A B"            -- ัะพะณะดะฐ ๐ = [-1, ๐0("A"), ๐0("A A"), ๐0("A A B"), ... , ๐0("A A B A A A B")]
๐ := [-1, 0, 1, 0, 1, 2, 2, 3]  -- ะผะฐััะธะฒ ะฟัะตัะธะบั-ััะฝะบัะธะธ, ๐[i] - ะทะฝะฐัะตะฝะธะต ััะฝะบัะธะธ ๐0 ะดะปั ะฟัะตัะธะบัะฐ ะดะปะธะฝั i
```

### ะะตัะตะฝะธะต:

ะะฐััะผะพััะธะผ ัััะพะบั ๐, ั ะบะพัะพัะพะน ะตััั ะฟะตัะธะพะด:

ะัะธะผะตั:

```haskell
s := "A A B B A A B B A A B B A A B B"  -- ะฟะตัะธะพะดั ๐ = 4, ๐ = 8
```

**ะะตะผะผะฐ 1**. ะะฐะผะตัะธะผ, ััะพ ะฒััะบะฐะทัะฒะฐะฝะธั **(1)** ะธ **(2)** ัะฐะฒะฝะพัะธะปัะฝั:

1. ะกััะตััะฒัะตั ะฟะตัะธะพะด ะดะปะธะฝั ๐
2. ะกัััะธะบั `๐[๐ : |๐|)` ัะฐะฒะตะฝ ะฟัะตัะธะบัั `๐[0 : |๐| - ๐)`

ะะพะบะฐะถะตะผ ััะพ ััะฒะตัะถะดะตะฝะธะต:

> `=>`
>
> ะขะฐะบ ะบะฐะบ ะตััั ะฟะตัะธะพะด ะดะปะธะฝั ๐:
>
> ะกะดะฒะธะณะฐะตะผ ะฟะพะดัััะพะบั `๐[๐ : |๐|)` ะฝะฐ ๐ ะฒะปะตะฒะพ, ะฟะพะปััะฐะตะผ ะฒ ัะพัะฝะพััะธ ะฟะพะดัััะพะบั `๐[0 : |๐| - ๐)`

> `<=`
>
> ะะฑัะฐัะฝะพะต ััะฒะตัะถะดะตะฝะธะต ัััั ะผะตะฝะตะต ะพัะตะฒะธะดะฝะพ.
> ะขะฐะบ ะบะฐะบ ััะปะพะฒะธะต **(2)** ะฒัะฟะพะปะฝัะตััั, ัะพ:
> ```haskell
> s[0 + i] = s[๐ + i], for all i in [0, |๐| - ๐)
> ```
> ะฐ ััะพ ะฒ ัะพัะฝะพััะธ ัะพะพัะฒะตัััะฒัะตั ะพะฟัะตะดะตะปะตะฝะธั _ะฟะตัะธะพะดะฐ_ ะธะท ะฟัะตะดัะดััะตะน ะทะฐะดะฐัะธ.

ะะฐะผะตัะธะผ, ััะพ *__ัะตะปัะน__* ะฟะตัะธะพะด ๐ ัััะพะบะธ ๐ ัะดะพะฒะปะตัะฒะพััะตั ััะปะพะฒะธั: `๐ โค |๐| / 2` (ะฟะพ ะพะฟัะตะดะตะปะตะฝะธั).

ะขะตะฟะตัั, ะดะปั ะฝะฐัะพะถะดะตะฝะธั _ะผะธะฝะธะผะฐะปัะฝะพะณะพ_ ะฟะพ ะดะปะธะฝะต ะฟะตัะธะพะดะฐ, ะฝะฐะผ ะพััะฐะปะพัั ะฝะฐะนัะธ _ะผะฐะบัะธะผะฐะปัะฝัะน_ ะฟะพ ะดะปะธะฝะต
ััััะธะบั `๐[i : |๐|)`, ะบะพัะพััะน ัะฐะฒะตะฝ ะฟัะตัะธะบัั `๐[0 : |๐| - i)` ะธ ะฒะพัะฟะพะปัะทะพะฒะฐัััั **ะะตะผะผะพะน 1**.

ะะปะธะฝะฐ ัะฐะบะพะณะพ ะผะฐะบั. ััััะธะบัะฐ ะบะฐะบ ัะฐะท ะฑัะปะฐ ะฟะพััะธัะฐะฝะฐ ะฒ ะผะฐััะธะฒะต ะฟัะตัะธะบั-ััะฝะบัะธะธ `๐[|๐|]` (ะทะฝะฐัะตะฝะธะต ััะฝะบัะธะธ ๐0 ะดะปั ะฒัะตะน
ัััะพะบะธ ๐). ะััะฐะปะพัั ะฝะฐะนัะธ ะดะปะธะฝั _ะบัะฐััะฐะนัะตะณะพ_ ะฟะตัะธะพะดะฐ `๐ = |๐| - ๐[|๐|]` (ัะฐะทะฝะพััั ะดะปะธะฝั ะฒัะตะน ัััะพะบะธ ๐ ะธ ะดะปะธะฝั
ะผะฐะบั. ัะพะฑััะฒะตะฝะฝะพะณะพ ััััะธะบัะฐ ัััะพะบะธ ๐, ัะพะฒะฟะฐะดะฐััะตะณะพ ั ะฟัะตัะธะบัะพะผ ัััะพะบะธ ๐).

**ะฃะฟัะฐะถะฝะตะฝะธะต**: ะฟัะธ ะบะฐะบะธั ััะปะพะฒะธัั ัะธัะปะฐ `|๐| - ๐[๐[|๐|]]`, `|๐| - ๐[๐[๐[|๐|]]]`, `|๐| - ๐[๐[๐[๐[|๐|]]]]`
, ... , ัะฒะปััััั ะฟะตัะธะพะดะฐะผะธ?